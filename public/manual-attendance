<%@ Page Language="C#" AutoEventWireup="true" CodeFile="Default.aspx.cs" Inherits="_Default" %>
<%@ Import Namespace="System.Data" %>
<%@ Import Namespace="System" %>
<%@ Import Namespace= "FireSharp.Interfaces" %>
<%@ Import Namespace= "FireSharp.Config" %>
<%@ Import Namespace= "FireSharp.EventStreaming" %>
<%@ Import Namespace= "FireSharp.Exceptions" %>
<%@ Import Namespace= "FireSharp.Extensions" %>
<%@ Import Namespace= "FireSharp.Response" %>
<%@ Import Namespace=" FireSharp" %>


<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title></title>

    
<script runat="server">
    public static DateTime today = new DateTime();
    public static DateTime todayReal = today.Date;
    public static String date = todayReal.ToString("MM/dd/yyyy");
    public static IFirebaseConfig config = new FirebaseConfig
    {
        AuthSecret = "AIzaSyDfDlnbBYJjijCLdoGg7WL0b3F4fb9bd_s",
        BasePath = "https://hasadna-attendance.firebaseio.com/"
    };
    IFirebaseClient client = new FirebaseClient(config);


    void PageLoad() {    }
    public static String printDataStr= "";
    async void FunctionName()
    {
        String lastname = "";
        int count=0;
        String name = Request.Form["FName"];
        var lastName = new  {
            name = "Execute SET find last names",
            priority = 2
        };
        String query = "firstName = "+name;
        SetResponse response = await client.SetAsync("hasadna-attendace/users", query);
        String[] result = response.ResultAs<String[]>();
        FirebaseResponse response2 = await client.GetAsync("hasadna-attendace/users");
        String[] todo=response2.ResultAs<String[]>();
        count = todo.Length;
        for (int i = 1; i <= count; i++)
        {
            lastname = todo[count-1];
            printDataStr += "<option>";
            printDataStr += lastname + "</option>";
        }
    }
async void functionUpdate()
    {
        var username = new  {
            name = "execute update",
            priority = 1
        };
FirebaseResponse response =await  client.UpdateAsync("hasadna-attendace/attendance/"+date, username);
String[]todo = response.ResultAs<String[]>();

    }


    </script>
     

    <style type="text/css">
        #LName {
            width: 170px;
        }
    </style>
     

</head>
<body>
    <form id="form1" runat="server">
        <input id="FName" type="text" />
        <select id="LName"> 
            <%=printDataStr %>
        </select>
        
    <button onclick="FunctionName()" style="width: 169px; margin-left: 74px">Click me</button>
        <br />
        <button onclick="ListUpdation()">Click me last</button>
    </form>
</body>

</html>
